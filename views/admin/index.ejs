<%- include("./../partials/header")%>

<!-- The Modal -->
<div id="adminModal" class="modal-chk">
  <!-- Modal content -->
  <div class="modal-content-chk" style="border-radius: 5px;">
  	<div class="container">
  		<div class="row d-flex justify-content-center">
  			<div class="circle-loader">
	  			<div class="checkmark draw"></div>
			</div>
  		</div>
	  	<div class="row  ">
	  		<div class="col-12 d-flex justify-content-center">
	  			<div class="desc wait">
	  				<h3 style="display: inline-block;">Περιμένετε όσο το <b>e-mail</b> στέλνεται</h2>
	  			</div>
	  			<div class="desc result hidden">
	  				<h3 style="display: inline-block;">Το <b>e-mail</b> στάλθηκε επιτυχώς</h2>
	  			</div>
			</div>
		</div>	
	</div>
  </div>
</div>


<div id="main" class="main container mb-5">
	<% if(!currentUser){ %>
	<div class="jumbotron">
		<h1>Η περίοδος σύνδεσής σας έχει λήξει</h1>
		<script type="text/javascript" src="/scripts/relocate.js"></script>
	</div>
	<% }else {%>

	<% orders.forEach(function(order){ %>
		<div class="row">
			<% if(order.confirm==true && order.complete==true){%>
				<div  class="container mt-2 px-2 card stripes">
			<%}else{ %>
				<div  class="container mt-2 px-2 card">
			<% }%>
				<div class="row justify-content-around ">
					<div class="col-7">
						<h5><b>ID παραγγελίας: </b><%=order._id %></h4>
						<!-- <h4 class="px-3">Μέθοδος: <%=order.method %></h3> -->
						<%if(order.paymentIntent){%>
							<h5><b>Stripe ID: </b><%= order.paymentIntent %></h5>
						<%}%>
					</div>
					<div class="col-5">	
						<div class="row pr-3 d-flex justify-content-end">	
							<span style="font-size: 14px;"><b>Ημερομηνία: </b><%=order.date %></span>
						</div>	
						<div class="row pt-3 pr-3 d-flex justify-content-end ">
							<p><b>Μέθοδος: </b><%=order.method %></p>
						</div>
					</div>
				</div>	
				<hr style="border: 0.2px solid rgba(0, 0, 0, 0.1); margin-top: -2px; ">
				<div class="row d-flex justify-content-around">
					
					<div class="col-12 col-sm-12 col-md-12 col-lg-6">
						<p><b>Όνομα: </b><%= order.details.name %></p>
						<p><b>Επίθετο: </b><%= order.details.surname %></p>	
						<p><b>E-mail: </b><%= order.details.email %></p>
						<p><b>Τηλέφωνο : </b><%= order.details.phone %></p>
					</div>
					<div class="col-12 col-sm-12 col-md-12 col-lg-6">
						<p><b>Διεύθυνση: </b><%= order.details.address.line1%></p>
						<p><b>Πόλη: </b><%= order.details.address.city%></p>	
						<p><b>Ταχ. Κώδικας: </b><%= order.details.address.zip%></p>
						<p><b>Νομός: </b><%= order.details.address.state%></p>
					</div>
				</div>
				<hr style="border: 0.2px solid rgba(0, 0, 0, 0.1);margin-top: -2px;">
				<div class="row d-flex justify-content-start">
					<%order.productList.forEach(function(productlist){%>
						<div class="col-12 col-sm-12 col-md-6 col-lg-4  mb-2 d-flex justify-content-center">
							<div class="mr-2" style="border-left: 1px solid grey; height: 110px;"></div>	
							<img class="mr-2" style="width:5em; height:7em;" src="<%=productlist.product.images[0].url %>" >
							<div >
								<p><b>Προϊόν: </b><%= productlist.product.name%></p>
								<p><b>Μέγεθος: </b>'<%=productlist.product.size%>' </p>
								<p><b>Ποσότητα: </b><%= productlist.quantity%></p>
							</div>
						</div>
					<%}) %>				
				</div>
				<% if(order.confirm==true && order.complete==true){%>
				    <img src="https://scorpion-store.herokuapp.com/images/check.png" style="width:2em; height: 2em; position:absolute; right:8px; top:45%;">
				<%}%>
				</div>
			</div>

			<div class="container my-2 button-div">
				<div class="row d-flex justify-content-center">
					<button class="btn btn-secondary order-btn mx-2" onclick="deleteOrder(<%= JSON.stringify(order) %>)">
						<i class="fas fa-trash-alt"></i> Διαγραφή  
					</button>   
				<% if(order.confirm==true){%>
					<button class="btn btn-success order-btn mx-2" disabled>
			          	<i class="fas fa-share "></i> Email Επιβεβαιωσης 
			        </button>
				<%}else{%>
					<button class="btn btn-secondary order-btn mx-2" onclick="verifyOrder(<%= JSON.stringify(order) %>)">
			          	<i class="fas fa-share "></i> Email Επιβεβαιωσης 
			        </button>
				<%}%>
				<% if(order.confirm==true && order.complete==true){%>
					<button class="btn btn-success order-btn mx-2" disabled>
		          		<i class="far fa-check-circle"></i> Ολοκληρωση
	       			</button>	
				<%}else if(order.confirm==true && order.complete==false){%>
					<button class="btn btn-secondary order-btn mx-2" onclick="completeOrder(<%= JSON.stringify(order) %>)">
		          		<i class="far fa-check-circle"></i> Ολοκληρωση
		        	</button>
		        <%}else{%>
		        	<button class="btn btn-secondary order-btn mx-2" disabled>
		          		<i class="far fa-check-circle"></i> Ολοκληρωση
		        	</button>
				<%}%>

			</div>
		</div>
		<hr style="border: 1px solid rgba(0, 0, 0, 0.1); ">
	<%})%>
	<% }%>
</div>


<script type="text/javascript" src="/scripts/admin.js"></script>

<%- include("./../partials/footer")%>